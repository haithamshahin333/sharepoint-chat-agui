###########################################################
# .env.example - Copy to .env and fill in real values (never commit real .env)
# This file documents required & optional variables used by deployment scripts.
# Conventions:
#   - REQUIRED: Must be set for the script(s) to run.
#   - OPTIONAL: Leave unset or empty unless you need that behavior.
#   - Placeholders use UPPER_CASE tokens; replace with your environment specifics.
###########################################################

###########################################################
# 1. GLOBAL (shared across scripts)
###########################################################
# Azure subscription GUID hosting all resources.
SUBSCRIPTION_ID="00000000-0000-0000-0000-000000000000"  # REQUIRED
# Resource group where core infrastructure (Bicep deployment) lives.
RESOURCE_GROUP="rg-myproject-dev"                       # REQUIRED
# Azure region (match base deployment). Example: eastus2, westeurope.
LOCATION="eastus2"                                      # REQUIRED
# TEMP_ALLOW_IP: If set (IPv4), scripts temporarily enable public access + allow this IP.
TEMP_ALLOW_IP=""                                         # OPTIONAL (e.g. 203.0.113.10)
# Toggle skipping steps in post-deploy orchestrator (any non-empty value skips)
SKIP_SEARCH_INDEX=""                                     # OPTIONAL
SKIP_FUNCTION_DEPLOY=""                                  # OPTIONAL
SKIP_LOGIC_WORKFLOWS=""                                  # OPTIONAL
# Mirror storage account name (used for deriving blob endpoint in logic workflows script)
STORAGE_ACCOUNT_MIRROR_NAME="stmyprojmirror"             # OPTIONAL

###########################################################
# 2. SEARCH INDEX CREATION (create-search-index.sh)
###########################################################
# Name of the index to create/update in Azure AI Search.
SEARCH_INDEX_NAME="chunk"                                 # REQUIRED
# Azure OpenAI endpoint used inside the index skillset / vector config (no trailing slash).
OPENAI_ENDPOINT="https://aoai-myproj-dev.openai.azure.com/"  # REQUIRED
# Embedding deployment logical name (as deployed in AOAI resource).
EMBEDDING_DEPLOYMENT_NAME="text-embedding-3-small"        # REQUIRED
# Embedding model name (if referenced; can mirror deployment name or actual model ID).
EMBEDDING_MODEL_NAME="text-embedding-3-small"             # REQUIRED
# Optional explicit search service name (otherwise discovery attempts via resource group).
# SEARCH_SERVICE="mysearchsvc123"                         # OPTIONAL
# Override API version for search service.
API_VERSION="2024-07-01"                                  # OPTIONAL
# Custom path to index JSON (default infra/search-index.json relative root)
# INDEX_FILE="../search-index.json"                       # OPTIONAL
# Explicit RG for search service if different from RESOURCE_GROUP
# SEARCH_RESOURCE_GROUP="rg-mysearch"                     # OPTIONAL

###########################################################
# 3. FUNCTION APP (deploy-ingest-function.sh)
###########################################################
# Logical name of the existing Function App (Flex Consumption or other plan) to publish to.
FUNCTION_APP_NAME="func-myproj-dev"                       # REQUIRED
# If the Function App lives in a different resource group.
# FUNCTION_RESOURCE_GROUP="rg-functions-dev"              # OPTIONAL
# Publish local.settings.json (generally false; secrets should not be pushed blindly)
# PUBLISH_LOCAL_SETTINGS="false"                          # OPTIONAL (true/false)

###########################################################
# 4. LOGIC APP STANDARD WORKFLOWS (deploy-logic-workflows.sh)
###########################################################
# Logic App Standard site name (workflowapp kind) where workflows reside.
LOGIC_APP_NAME="logic-myproj-dev"                         # REQUIRED (for workflows deploy)
# If Logic App in a different RG.
# LOGIC_APP_RESOURCE_GROUP="rg-logic-dev"                # OPTIONAL

###########################################################
# 5. SHAREPOINT CONNECTION (Logic App data connection discovery)
###########################################################
# Provide when multiple SharePoint connections exist or discovery fails.
# SHAREPOINT_CONNECTION_NAME="sharepointonline"          # OPTIONAL
# SHAREPOINT_CONNECTION_RG="rg-connections-dev"         # OPTIONAL
# SHAREPOINT_CONNECTION_RUNTIME_URL="https://..."       # OPTIONAL (bypass discovery)

###########################################################
# 6. FUNCTION HOST KEYS (override discovery) - Sensitive
###########################################################
# Provide only if you want to SKIP automated key retrieval. Leave commented for auto-discovery.
# azureFunctionOperation_functionAppKey="<FUNCTION_HOST_KEY>"  # OPTIONAL (sensitive)

###########################################################
# 7. FRONTEND (Next.js) DEPLOY (deploy-next-webapp.sh)
###########################################################
# Web App name for the Next.js frontend.
WEBAPP_NAME="web-myproj-dev"                              # REQUIRED if deploying frontend
# WEBAPP_RESOURCE_GROUP="rg-web-dev"                     # OPTIONAL (if different)
# Directory containing the Next.js project (default ../frontend)
# FRONTEND_DIR="../frontend"                              # OPTIONAL
# Build flags (Oryx remote build)
SCM_DO_BUILD_DURING_DEPLOYMENT="true"                     # OPTIONAL (true/false)
ENABLE_ORYX_BUILD="true"                                  # OPTIONAL (true/false)

###########################################################
# 8. NEXT.JS PUBLIC RUNTIME CONFIG (exposed to browser) - Non-secret
###########################################################
NEXT_PUBLIC_MSAL_CLIENT_ID="00000000-0000-0000-0000-000000000000"      # REQUIRED if MSAL auth
NEXT_PUBLIC_MSAL_TENANT_ID="11111111-1111-1111-1111-111111111111"      # REQUIRED if MSAL auth
NEXT_PUBLIC_API_SCOPE="api://22222222-2222-2222-2222-222222222222/access_as_user"  # REQUIRED if using custom API scope
NEXT_PUBLIC_SEARCH_CATEGORIES='[{"value":"all","label":"All Categories"}]'  # OPTIONAL JSON array
NEXT_PUBLIC_DEFAULT_CATEGORY="all"                                   # OPTIONAL
COPILOTKIT_TELEMETRY_DISABLED="true"                                  # OPTIONAL
POST_BUILD_COMMAND="mkdir -p .next/standalone/public && cp -R public .next/standalone/ 2>/dev/null || true; mkdir -p .next/standalone/.next && cp -R .next/static .next/standalone/.next/"  # OPTIONAL

###########################################################
# 9. BACKEND FASTAPI WEB APP (deploy-fastapi-webapp.sh)
###########################################################
BACKEND_WEBAPP_NAME="api-myproj-dev"                        # REQUIRED if deploying backend
# BACKEND_WEBAPP_RESOURCE_GROUP="rg-api-dev"               # OPTIONAL
BACKEND_DIR="../pydantic-agent"                            # REQUIRED if backend deployment used
BACKEND_STARTUP_COMMAND="python -m uvicorn main:app --host 0.0.0.0 --port 8000"  # OPTIONAL override
PYDANTIC_AGENT_URL="http://localhost:8000/"                 # OPTIONAL (frontend local dev proxy)

###########################################################
# 10. BACKEND DOMAIN / SEARCH / STORAGE / AI CONFIG
###########################################################
# Azure OpenAI endpoint consumed by backend (no trailing slash)
AZURE_OPENAI_ENDPOINT="https://aoai-myproj-dev.openai.azure.com/"
AZURE_OPENAI_API_VERSION="2025-01-01-preview"               # Check current preview/stable version
AZURE_OPENAI_DEPLOYMENT_NAME="gpt-4o"                       # Deployed model deployment name
# Storage account canonical name (used for building endpoints / SAS outside code)
AZURE_STORAGE_ACCOUNT_NAME="stmyprojdev"
# Azure AI Search endpoint + index metadata
AZURE_SEARCH_ENDPOINT="https://mysearchsvc.search.windows.net"
AZURE_SEARCH_INDEX_NAME="chunk"
AZURE_SEARCH_SEMANTIC_CONFIG="semantic-configuration"       # If configured; optional else blank
DEFAULT_CATEGORY_VALUE="all"
API_HOSTNAME="http://localhost:8000"                        # Backend base URL for internal calls
OTEL_EXPORTER_OTLP_ENDPOINT="http://localhost:4318"         # OpenTelemetry collector endpoint

###########################################################
# 11. COSMOS DB (Logic App discovery) - Provide if auto-discovery insufficient
###########################################################
# COSMOS_ACCOUNT_NAME="cosmos-myproj-dev"                  # OPTIONAL (for connection string retrieval)
# COSMOS_ACCOUNT_RG="rg-cosmos-dev"                        # OPTIONAL if different
# COSMOS_CONNECTION_STRING="AccountEndpoint=...;..."       # OPTIONAL (bypass key lookup) SENSITIVE
# AZURE_COSMOS_CONNECTION_STRING="AccountEndpoint=...;..." # OPTIONAL alt name SENSITIVE

###########################################################
# 12. OPTIONAL AZ CONTEXT OVERRIDE
###########################################################
# If you need scripts to switch subscription context automatically.
# AZ_SUBSCRIPTION_ID="00000000-0000-0000-0000-000000000000"  # OPTIONAL

###########################################################
# 13. NOTES & BEST PRACTICES
###########################################################
# - Never commit the real .env file. This example is safe to commit.
# - Store secrets (keys, connection strings) in Azure Key Vault or pipeline secret stores.
# - Only put non-secret, environment coordination values here when possible.
# - For Function keys & Cosmos connection strings prefer managed identities / RBAC where available.
# - TEMP_ALLOW_IP should be used sparingly; rely on private networking normally.
# - Keep client IDs (public) distinct from client secrets (never put secrets here).
###########################################################
